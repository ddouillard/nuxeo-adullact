<?xml version="1.0"?>
<component name="org.nuxeo.adullact.importer.ImporterComponent.adullact.contrib" version="1.0">

 <extension target="org.nuxeo.adullact.importer.ImporterComponent"
    point="documentMapping">

  <docConfig tagName="seance">
    <docType>WebDelibSeance</docType>
    <name>@IdSeance</name>
  </docConfig>

  <docConfig tagName="dossierActe">
    <docType>WebDelibActe</docType>
    <name>Acte-{{@idActe}}</name>
    <parent><![CDATA[ #{nodes = currentElement.selectNodes('@refSeance');
                        if (nodes.size()>0) {
                          String seanceRef = nodes.get(0).getText();
                          String parentRef = '//seance[@idSeance=\"' + seanceRef + '\"]';
                          return xml.selectNodes(parentRef).get(0);
                        } else {
                          return root.getPathAsString();
                        }}]]>
    </parent>
  </docConfig>

  <docConfig tagName="document">
    <docType>WebDelibDocument</docType>
    <name>@nom</name>
    <parent>..</parent>
  </docConfig>

 </extension>

 <extension target="org.nuxeo.adullact.importer.ImporterComponent"
    point="attributeMapping">

  <!-- SEANCE -->
  <attributeConfig tagName="typeSeance" docProperty="webdelibseance:type" xmlPath="text()"/>
  <!-- <attributeConfig tagName="dateSeance" docProperty="webdelibseance:date_seance" xmlPath="??"/> -->
  <!-- <attributeConfig tagName="dateConvocation" docProperty="webdelibseance:date_convocation" xmlPath="??"/> -->
  <attributeConfig tagName="seance" docProperty="webdelibseance:idSeance" xmlPath="@idSeance"/>

  <!-- ACTE -->
  <attributeConfig tagName="titre" docProperty="dc:title" xmlPath="text()"/>
  <attributeConfig tagName="description" docProperty="dc:description" xmlPath="text()"/>
  <attributeConfig tagName="dateACTE" docProperty="webdelibacte:date" xmlPath="text()"/>
  <attributeConfig tagName="numeroACTE" docProperty="webdelibacte:numero" xmlPath="text()"/>
  <attributeConfig tagName="themeACTE" docProperty="webdelibacte:theme" xmlPath="text()"/>
  <attributeConfig tagName="emetteurACTE" docProperty="webdelibacte:emetteur" xmlPath="text()"/>
  <attributeConfig tagName="redacteurACTE" docProperty="webdelibacte:redacteur" xmlPath="text()"/>
  <attributeConfig tagName="rapporteurACTE" docProperty="webdelibacte:rapporteur" xmlPath="text()"/>
  <attributeConfig tagName="cantonACTE" docProperty="webdelibacte:canton" xmlPath="text()"/>
  <attributeConfig tagName="communeACTE" docProperty="webdelibacte:commune" xmlPath="text()"/>
  <attributeConfig tagName="typeseanceACTE" docProperty="webdelibacte:type" xmlPath="text()"/>
  <attributeConfig tagName="listeCommissions" docProperty="webdelibacte:commissions" xmlPath="text()"/>


  <!-- DOCUMENT -->
  <attributeConfig tagName="document" docProperty="dc:title" xmlPath="@nom"/>
  <attributeConfig tagName="document" docProperty="file:filename" xmlPath="@nom"/>
  <!-- <attributeConfig tagName="mimetype" docProperty="file:content/mime-type" xmlPath="text()"/>
  <attributeConfig tagName="encoding" docProperty="file:content/encoding" xmlPath="text()"/> -->
  <attributeConfig tagName="document" docProperty="webdelibdocument:type" xmlPath="@type"/>
  <attributeConfig tagName="signature" docProperty="webdelibdocument:format_signature" xmlPath="@formatSignature"/>


  <!--  TD EXAMPLES <attributeConfig tagName="titre" docProperty="dc:title" xmlPath="text()"/>
  attributeConfig tagName="seance" docProperty="dc:title" xmlPath="#{currentDocument.title + ' - ' + currentDocument['dc:created']}"/
  <attributeConfig tagName="dossierActe" docProperty="dc:source" xmlPath="#{'Seance ' + currentDocument.name}"/>
  <attributeConfig tagName="document" docProperty="dc:title" xmlPath="@nom"/>
  <attributeConfig tagName="document" docProperty="dc:source" xmlPath="@type"/>

  <attributeConfig tagName="signature" docProperty="dc:format" xmlPath="@formatSignature"/>

  <attributeConfig tagName="document" docProperty="file:content">
    <mapping documentProperty="filename">@nom</mapping>
    <mapping documentProperty="mimetype">mimetype/text()</mapping>
    <mapping documentProperty="content">@nom</mapping>
  </attributeConfig>
  -->

 </extension>

</component>
